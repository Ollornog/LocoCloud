---
# inventories/kunde-{{ kunde_id }}/group_vars/all.yml
# Customer: {{ kunde_name }}
# Generated by: scripts/new-customer.sh

# --- Customer identity ---
kunde_name: "{{ kunde_name }}"
kunde_domain: "{{ kunde_domain }}"
kunde_id: "{{ kunde_id }}"

# --- Deployment variant ---
variante: "{{ variante }}"           # hybrid | cloud_only | lokal_only
isolation_mode: "single_lxc"         # single_lxc | lxc_per_app

# --- Admin user ---
admin_user: "srvadmin"
admin_ssh_pubkeys: []  # Add master SSH public key

# --- Netbird ---
netbird_setup_keys:
  online: "{{ '{{ vault_netbird_key_online }}' }}"
  lokal: "{{ '{{ vault_netbird_key_lokal }}' }}"
netbird_group: "kunde-{{ kunde_id }}"

# --- Customer users ---
kunden_users: []
#  - username: "m.mustermann"
#    display_name: "Max Mustermann"
#    email: "m.mustermann@{{ kunde_domain }}"

kunden_emails: "{{ '{{ kunden_users | map(attribute=\\'email\\') | list }}' }}"

# --- Apps ---
apps_enabled: []
#  - name: "Nextcloud"
#    subdomain: "cloud"
#    port: 8080
#    image: "nextcloud:29"
#    target: "lokal"               # lokal | online
#    netbird_ip: ""                # Netbird IP of the LXC (lxc_per_app)
#    oidc_enabled: true
#    oidc_redirect_path: "/apps/user_oidc/code"
#    needs_db: true
#    db_type: "mariadb"
#    needs_redis: true
#    redis_db: 0
#    public_paths:
#      - "/index.php/s/*"
#      - "/s/*"
#    backup_paths:
#      - "/mnt/data/nextcloud"

# --- Backup ---
backup:
  enabled: false
  targets: []
  retention:
    keep_daily: 7
    keep_weekly: 4
    keep_monthly: 6

# --- DynDNS (lokal_only only) ---
dyndns:
  enabled: false
  provider: "master"
